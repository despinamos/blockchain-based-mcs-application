<!DOCTYPE html>
<html>

<head>
	<title> Frontend </title>

	<!-- import Web3.js -->
	<script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
	<script src="./bundle.js" defer></script>

 
</head>

<body>
	<h1>
		HomePage
	</h1>

	<!-- placeholders -->
	<div id="provider"></div>
	<div id="connectedAccount"></div>
	<div id="warn" style="color: red"></div>

	<div>
		<button id="requestAccounts">Connect to Metamask</button>
	</div>

	<form id="dataForm">
		<label for="username">Enter Full Name to Register:</label>
		<input type="text" id="username">
		<button type="submit" onclick="interact()" defer>Submit form</button>
	</form>

	<script>
		
		if (window.ethereum) {
			// use the injected Ethereum provider to initialize Web3.js
			const web3 = new Web3(window.ethereum);
			try {
				if (typeof window.ethereum !== 'undefined') {
					console.log('MetaMask is installed!');
				}
			} catch (error) {
				console.error('Metamask is NOT installed...' + error);
			}
			

			// check if Ethereum provider comes from MetaMask
			if (window.ethereum.isMetaMask) {
				document.getElementById('provider').innerText =
					'Connected to Ethereum with MetaMask.';
			} else {
				document.getElementById('provider').innerText =
					'Non-MetaMask Ethereum provider detected.';
			}

			// click event for "Request MetaMask Accounts" button
			document.getElementById('requestAccounts').addEventListener('click', async () => {
				// request accounts from MetaMask
				await window.ethereum.request({ method: 'eth_requestAccounts' });
				document.getElementById('requestAccounts').remove();

				// get list of accounts
				const accounts = await web3.eth.getAccounts();
				// get the first account and populate placeholder
				document.getElementById(
					'connectedAccount',
				).innerText = `Account: ${accounts[0]}`;
			});

		} else {
			// no Ethereum provider - instruct user to install MetaMask
			document.getElementById('warn').innerHTML =
				"Please <a href='https://metamask.io/download/'>install MetaMask</a>.";
			document.getElementById('requestAccounts').disabled = true;
		}

	</script>

	<button onclick="getLocation()" defer>Give Location (city)</button>

		<script>
		//	let cityNameGlobal = getLocation();

		//	window.alert(cityNameGlobal);
			
			
			// const userContract = new web3.eth.Contract(userAbi, userContractAddress);
			// userContract.handleRevert = true;

			// try {
		
			// Interact with the user contract
					//Register user
			// 		const receipt = await userContract.methods.setUser_Information(name).send({
			// 			from: defaultAccount,
			// 			gas: 1000000,
			// 			gasPrice: '10000000000',
			// 		});
			// 		console.log('Transaction Hash: ' + receipt.transactionHash);

			// 		// Get user info
			// 		const userInfo = await userContract.methods.getUserInformation(0).call();
			// 		console.log('User information: ' + userInfo);
		
			// alert("Data successfully stored on the blockchain!");
			// } catch (error) {
			// 			console.error(error);
			// }
				
	</script>
</body>

</html>